<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
  <title>MAKEY XYLO</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/p5.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/addons/p5.sound.js"></script>

  <script>
    const keys = {
      87: {
        note: "a5",
        sound: 'https://www.dl.dropboxusercontent.com/s/xhqseodrgfdt0i2/a5.mp3',
        currentColor: [255, 0, 0]
      },
      65: {
        note: "b5",
        sound: 'https://www.dl.dropboxusercontent.com/s/d2g6bsst7ywg1lo/b5.mp3',
        currentColor: [255, 0, 0]
      },
      83: {
        note: "c5",
        sound: 'https://www.dl.dropboxusercontent.com/s/ccaswpookmdk3n4/c5.mp3',
        currentColor: [255, 0, 0]
      },
      68: {
        note: "c6",
        sound: 'https://www.dl.dropboxusercontent.com/s/ih2tk20jhui85x8/c6.mp3',
        currentColor: [255, 0, 0]
      },
      32: {
        note: "d5",
        sound: 'https://www.dl.dropboxusercontent.com/s/scxp2howqhpkcg6/d5.mp3',
        currentColor: [255, 0, 0]
      },
      39: {
        note: "e5",
        sound: 'https://www.dl.dropboxusercontent.com/s/ie7vbqzllol7k1z/e5.mp3',
        currentColor: [255, 0, 0]
      },
      40: {
        note: "e6",
        sound: 'https://www.dl.dropboxusercontent.com/s/ds6ggo0t9nipx1e/e6.mp3',
        currentColor: [255, 0, 0]
      },
      38: {
        note: "f5",
        sound: 'https://www.dl.dropboxusercontent.com/s/0f6ob8f07wtbdoz/f5.mp3',
        currentColor: [255, 0, 0]
      },
      70: {
        note: "f6",
        sound: 'https://www.dl.dropboxusercontent.com/s/jed4zmy277hp1c6/f6.mp3',
        currentColor: [255, 0, 0]
      },
      71: {
        note: "g5",
        sound: 'https://www.dl.dropboxusercontent.com/s/8xngpox41qa102g/g5.mp3',
        currentColor: [255, 0, 0]
      }
    };

    function preload() {
      // Basically for each note's sound file, tell p5js to load it from that url as a playable sound and then replace that property.
      for (const key in keys) {
        keys[key].sound = loadSound(keys[key].sound);
        keys[key].currentColor = color(...keys[key].currentColor); // Spread operator to use the array of rgb as parameters
      }
    }

    function setup() {
      createCanvas(850, 775);
      background(150);
    }

    function draw() {
      drawKeys();
    }

    function drawKeys() {
      const validKeys = Object.keys(keys);
      const len = validKeys.length;

      for (let i = 0; i < len; i++) {
        const coords = [(15 + i * (width / len)), 50, 45, 650 - (i * 50)]
        fill(keys[validKeys[i]].currentColor);
        rect(...coords); // Draw the rectangles with the coordinates specified in the coords array
        fill(0);
        textSize(20);
        text(keys[validKeys[i]].note.toUpperCase(), coords[0] + 11, coords[3] + 15);
      }
    }

    function keyPressed() {
      if (keys[keyCode] !== undefined) { // If the key pressed is a valid note, then play the sound and highlight the key.
        keys[keyCode].sound.play();
        keys[keyCode].currentColor = [255, 255, 0];
      }
    }

    function keyReleased() {
      if (keys[keyCode] !== undefined) keys[keyCode].currentColor = [255, 0, 0];
    }
  </script>
</head>

<body>
<form><input TYPE="button" onClick="history.go(0)" value="Reset"></form>
    <div id="code" class="container-fluid">
        <script src="https://gist-it.appspot.com/github/alexy4744/p5js/blob/master/MAKEY-XYLO.html?footer=0"></script>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script>
        $(window).bind("load", function() {
            $('#code').before($('#defaultCanvas0').remove());
        });
    </script>
</body>

</html>
